_prefs: 
  disabled: 
    - boundingbox
  inspector: false
  mapid: ''
  rev: ''
  saveCenter: false
attribution: ''
metatile: 1
center: 
  - -75.6038
  - 40.0799
  - 11
description: ''
Layer: 
  - id: boundingbox
    Datasource: 
      file: /home/pnorman/mq-carto-style-vector/10m-900913-bounding-box.shp
      type: shape
    description: The entire world
    fields: 
      Id: Number
    properties: 
      "buffer-size": 2
    srs: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over
  - id: water
    Datasource: 
      dbname: ''
      extent: -20037508,-20037508,20037508,20037508
      geometry_field: geom
      geometry_table: ''
      host: ''
      key_field: ''
      max_size: 512
      password: ''
      port: ''
      table: |-
        (SELECT
            geom
          FROM mq_water_polygon
          WHERE ST_Area(geom)/NULLIF(!pixel_width!::float*!pixel_height!::float, 0) > 0.25
        ) AS water
      type: postgis
      user: ''
    description: Areas covered by water. Includes oceans.
    fields: {}
    properties: 
      "buffer-size": 2
    srs: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over
  - id: landmark_polygon
    Datasource: 
      dbname: ''
      extent: -20037508,-20037508,20037508,20037508
      geometry_field: geom
      geometry_table: ''
      host: ''
      key_field: ''
      max_size: 512
      password: ''
      port: ''
      table: |-
        (SELECT
            geom, landmark
          FROM mq_landmark
          WHERE ST_Area(geom)/NULLIF(!pixel_width!::float*!pixel_height!::float, 0) > 0.25 -- This also excludes ST_Points
          ORDER BY zlevel ASC, area DESC
        ) AS landmark_polygon
      type: postgis
      user: ''
    description: Area features for background drawing
    fields: 
      landmark: Landmark type
    properties: 
      "buffer-size": 8
    srs: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over
  - id: buildings
    Datasource:
      dbname: ''
      extent: -20037508,-20037508,20037508,20037508
      geometry_field: geom
      geometry_table: ''
      host: ''
      key_field: ''
      max_size: 512
      password: ''
      port: ''
      table: |-
        (SELECT
            geom
          FROM mq_building
          WHERE z(!scale_denominator!) >= 12
        ) AS buildings
      type: postgis
      user: ''
    description: Buildings
    fields:
    properties:
      "buffer-size": 2
    srs: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over
  - id: admin_lines
    Datasource: 
      dbname: ''
      extent: -20037508,-20037508,20037508,20037508
      geometry_field: geom
      geometry_table: ''
      host: ''
      key_field: ''
      max_size: 512
      password: ''
      port: ''
      table: |-
        (SELECT 
            geom, admin
          FROM mq_admin_line
          WHERE z(!scale_denominator!) < 6 AND admin IN ('country','state')
            OR (z(!scale_denominator!) >= 6 AND z(!scale_denominator!) < 12 AND admin IN ('country','state','county','township'))
            OR z(!scale_denominator!) >= 12
          ORDER BY admin DESC
        ) AS admin_lines
      type: postgis
      user: ''
    description: ''
    fields: 
      admin: Number
    properties: 
      "buffer-size": 8
    srs: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over
  - id: trans_linear
    Datasource: 
      dbname: ''
      extent: -20037508,-20037508,20037508,20037508
      geometry_field: geom
      geometry_table: ''
      host: ''
      key_field: ''
      max_size: 512
      password: ''
      port: ''
      table: |-
        (SELECT
            geom, transportation::text, display_class, brunnel, NULL as ramp, NULL as toll
          FROM mq_transportation
          WHERE st_geometrytype(geom) = 'ST_LineString'
            AND ((z(!scale_denominator!) >= 4
                AND z(!scale_denominator!) < 8
                AND transportation = 'road' AND display_class = 0)
              OR (z(!scale_denominator!) >= 8
                AND z(!scale_denominator!) < 10
                AND transportation = 'road' AND display_class BETWEEN 0 AND 2)
              OR (z(!scale_denominator!) >= 10
                AND z(!scale_denominator!) < 12
                AND ((transportation = 'road' AND display_class BETWEEN 0 AND 3)
                  OR transportation = 'ferry'))
              OR (z(!scale_denominator!) >= 12
                AND z(!scale_denominator!) < 14
                AND ((transportation = 'road' AND display_class BETWEEN 0 AND 4)
                  OR transportation = 'ferry')
                  OR transportation = 'rail')
              OR (z(!scale_denominator!) >= 14
                AND z(!scale_denominator!) < 16
                AND transportation IN ('road', 'ferry', 'rail'))
              OR z(!scale_denominator!) >= 16)
          ORDER BY zlevel ASC,
            transportation, -- probably needs a better ordering here
            display_class DESC
        ) AS trans_linear
      type: postgis
      user: ''
    description: ''
    fields: 
    properties: 
      "buffer-size": 16
    srs: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over
  - id: highway_labels
    Datasource: 
      dbname: ''
      extent: -20037508,-20037508,20037508,20037508
      geometry_field: geom
      geometry_table: ''
      host: ''
      key_field: ''
      max_size: 512
      password: ''
      port: ''
      table: |-
        (SELECT
            geom,
            -- This is a bit of a hack to split them out, because vector tiles can't handle arrays
            -- Also, it ignores shield_priorities as that's very difficult to handle without 9.4
            split_part(tags->'INT-shield', ',', 1) AS shield1,
            split_part(tags->'INT-shield_banner', ',', 1) AS shield1_banner,
            split_part(tags->'INT-shield_number', ',', 1) AS shield1_number,
            length(split_part(tags->'INT-shield_number', ',', 1)) AS shield1_number_length,
            split_part(tags->'INT-shield_prefix', ',', 1) AS shield1_prefix,
            split_part(tags->'INT-shield', ',', 2) AS shield2,
            split_part(tags->'INT-shield_banner', ',', 2) AS shield2_banner,
            split_part(tags->'INT-shield_number', ',', 2) AS shield2_number,
            length(split_part(tags->'INT-shield_number', ',', 2)) AS shield2_number_length,
            split_part(tags->'INT-shield_prefix', ',', 2) AS shield2_prefix,
            split_part(tags->'INT-shield', ',', 3) AS shield3,
            split_part(tags->'INT-shield_banner', ',', 3) AS shield3_banner,
            split_part(tags->'INT-shield_number', ',', 3) AS shield3_number,
            length(split_part(tags->'INT-shield_number', ',', 3)) AS shield3_number_length,
            split_part(tags->'INT-shield_prefix', ',', 3) AS shield3_prefix,
            split_part(tags->'INT-shield', ',', 4) AS shield4,
            split_part(tags->'INT-shield_banner', ',', 4) AS shield4_banner,
            split_part(tags->'INT-shield_number', ',', 4) AS shield4_number,
            length(split_part(tags->'INT-shield_number', ',', 4)) AS shield4_number_length,
            split_part(tags->'INT-shield_prefix', ',', 4) AS shield4_prefix
          FROM mq_transportation
            WHERE shield_count > 0
              AND ((z(!scale_denominator!) >= 4
              AND z(!scale_denominator!) < 8
              AND transportation = 'road' AND display_class = 0)
            OR (z(!scale_denominator!) >= 8
              AND z(!scale_denominator!) < 10
              AND transportation = 'road' AND display_class BETWEEN 0 AND 2)
            OR (z(!scale_denominator!) >= 10
              AND z(!scale_denominator!) < 12
              AND ((transportation = 'road' AND display_class BETWEEN 0 AND 3)
                OR transportation = 'ferry'))
            OR (z(!scale_denominator!) >= 12
              AND z(!scale_denominator!) < 14
              AND ((transportation = 'road' AND display_class BETWEEN 0 AND 4)
                OR transportation = 'ferry')
                OR transportation = 'rail')
            OR (z(!scale_denominator!) >= 14
              AND z(!scale_denominator!) < 16
              AND transportation IN ('road', 'ferry', 'rail'))
            OR z(!scale_denominator!) >= 16)
          ORDER BY display_class DESC
        ) AS trans_linear
      type: postgis
      user: ''
    description: 'Highway shields'
    fields: 
      display_class: Number
      name: String
      name_len: Number
    properties: 
      "buffer-size": 64
    srs: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over
  - id: place_labels
    Datasource: 
      dbname: ''
      extent: -20037508,-20037508,20037508,20037508
      geometry_field: geom
      geometry_table: ''
      host: ''
      key_field: ''
      max_size: 512
      password: ''
      port: ''
      table: |-
        (SELECT
            geom, label AS name,  admin, display_class
          FROM mq_admin_point
          ORDER BY display_class ASC NULLS LAST,
            population DESC NULLS LAST
        ) AS place_labels
      type: postgis
      user: ''
    description: ''
    fields: 
      class: Number
      display_class: Number
      name: String
    properties: 
      "buffer-size": 64
    srs: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over
  - id: highway_overlay
    Datasource: 
      dbname: ''
      extent: -20037508,-20037508,20037508,20037508
      geometry_field: geom
      geometry_table: ''
      host: ''
      key_field: ''
      max_size: 512
      password: ''
      port: ''
      table: |-
        (SELECT
            geom, display_class
          FROM mq_transportation
          WHERE transportation = 'road'
            AND display_class = 0
        ) AS highway_overlay
      type: postgis
      user: ''
    description: Highway geometries, for the purpose of excluding other labels
    fields: {}
    properties: 
      "buffer-size": 16
    srs: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over
  - id: trans_linear_labels
    Datasource: 
      dbname: ''
      extent: -20037508,-20037508,20037508,20037508
      geometry_field: geom
      geometry_table: ''
      host: ''
      key_field: ''
      max_size: 512
      password: ''
      port: ''
      table: |-
        (SELECT
            geom, label AS name, transportation, display_class -- also needs toll
          FROM mq_transportation
          WHERE label IS NOT NULL
              AND ((z(!scale_denominator!) >= 4
              AND z(!scale_denominator!) < 8
              AND transportation = 'road' AND display_class = 0)
            OR (z(!scale_denominator!) >= 8
              AND z(!scale_denominator!) < 10
              AND transportation = 'road' AND display_class BETWEEN 0 AND 2)
            OR (z(!scale_denominator!) >= 10
              AND z(!scale_denominator!) < 12
              AND ((transportation = 'road' AND display_class BETWEEN 0 AND 3)
                OR transportation = 'ferry'))
            OR (z(!scale_denominator!) >= 12
              AND z(!scale_denominator!) < 14
              AND ((transportation = 'road' AND display_class BETWEEN 0 AND 4)
                OR transportation = 'ferry')
                OR transportation = 'rail')
            OR (z(!scale_denominator!) >= 14
              AND z(!scale_denominator!) < 16
              AND transportation IN ('road', 'ferry', 'rail'))
            OR z(!scale_denominator!) >= 16)
            ORDER BY zlevel ASC,
            transportation, -- probably needs a better ordering here
            display_class DESC
        ) AS trans_linear_labels
      type: postgis
      user: ''
    description: 'Labels for linear transportation features'
    fields: 
      name: String
      rclass: Number
    properties: 
      "buffer-size": 64
    srs: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over
#  - id: vector_point_labels2
#    Datasource: 
#      dbname: ''
#      extent: -20037508,-20037508,20037508,20037508
#      geometry_field: the_geom
#      geometry_table: ''
#      host: ''
#      key_field: ''
#      max_size: 512
#      password: ''
#      port: ''
#      table: |-
#        (SELECT 
#            the_geom, class, name, display_class
#          FROM 
#          (SELECT
#              placement_id, label_id, min_zoom, max_zoom, the_geom, class,
#              unnest(text_elements) AS name, display_class, feature_area
#            FROM 
#            (SELECT 
#                pl.*, (unnest(pr.labels)).* 
#              FROM vector_point_label_placements pl 
#              INNER JOIN vector_point_label_properties pr ON pl.label_id = pr.label_id) x
#              WHERE class NOT IN (1000, 1010, 1020, 1030, 1031, 1038) 
#                AND class NOT BETWEEN 1 AND 591
#                AND class NOT IN (1040, 1041, 1042)
#                AND z(!scale_denominator!) >= min_zoom 
#                AND (z(!scale_denominator!) < max_zoom+1 OR max_zoom IS NULL OR max_zoom = 18)
#            ORDER BY display_class ASC) 
#          AS data0)
#        AS vector_point_labels2
#      type: postgis
#      user: ''
#    description: ''
#    fields: 
#      class: Number
#      display_class: Number
#      name: String
#    properties: 
#      "buffer-size": 64
#    srs: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over
#  - id: vector_point_labels3
#    Datasource: 
#      dbname: ''
#      extent: -20037508,-20037508,20037508,20037508
#      geometry_field: the_geom
#      geometry_table: ''
#      host: ''
#      key_field: ''
#      max_size: 512
#      password: ''
#      port: ''
#      table: |-
#        (SELECT 
#            the_geom, class, name, display_class
#          FROM 
#          (SELECT
#              placement_id, label_id, min_zoom, max_zoom, the_geom, class,
#              unnest(text_elements) AS name, display_class, feature_area
#            FROM 
#            (SELECT 
#                pl.*, (unnest(pr.labels)).* 
#              FROM vector_point_label_placements pl 
#              INNER JOIN vector_point_label_properties pr ON pl.label_id = pr.label_id) x
#              WHERE class NOT IN (1000, 1010, 1020, 1030, 1031, 1038) 
#                AND class NOT BETWEEN 1 AND 591
#                AND class NOT IN (1040, 1041, 1042)
#                AND z(!scale_denominator!) >= min_zoom 
#                AND (z(!scale_denominator!) < max_zoom+1 OR max_zoom IS NULL OR max_zoom = 18)
#            ORDER BY display_class ASC) 
#          AS p)
#        AS vector_point_labels3
#      type: postgis
#      user: ''
#    description: ''
#    fields: 
#      class: Number
#      display_class: Number
#      name: String
#    properties: 
#      "buffer-size": 64
#    srs: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over
maxzoom: 16
minzoom: 0
name: MQ Carto Vector
