<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE Map[]>
<Map srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">

<Parameters>
  <Parameter name="center">-76.1167,40.0426,11</Parameter>
  <Parameter name="format">pbf</Parameter>
  <Parameter name="json"><![CDATA[{"vector_layers":[{"id":"boundingbox","description":"","fields":{"Id":"Number"}},{"id":"natearth_ocean_10m","description":"Low-zoom Natural Earth sourced oceans","fields":{}},{"id":"natearth_lakes_10m","description":"","fields":{}},{"id":"vector_polygonal_geometry","description":"","fields":{"id":"Number","rclass":"Number"}},{"id":"vector_linear_county","description":"","fields":{"id":"Number","rclass":"Number","ramp":"Boolean","toll":"Boolean","restriction":"Boolean","oneway":"Boolean","brunnel":"Number","admin_level":"Number"}},{"id":"states","description":"Natural Earth sourced state boundaries","fields":{"name":"State name","adm0_a3":"Three letter code of the parent country"}},{"id":"countries","description":"Natural Earth sourced country boundaries","fields":{"name":"Country name"}},{"id":"natearth_roads","description":"","fields":{"type":"String"}},{"id":"trans_linear","description":"","fields":{"rclass":"Number","ramp":"Boolean","toll":"Boolean","restriction":"Boolean","oneway":"Boolean","brunnel":"Number"}},{"id":"highway_labels","description":"","fields":{"class":"Number","name":"String","name_len":"Number","display_class":"Number"}},{"id":"place_labels","description":"","fields":{"class":"Number","name":"String","name_len":"Number","display_class":"Number"}},{"id":"highway_overlay","description":"Highway geometries, for the purpose of excluding other labels","fields":{"id":"Number","rclass":"Number","ramp":"Boolean","toll":"Boolean","restriction":"Boolean","oneway":"Boolean","brunnel":"Number","admin_level":"Number"}},{"id":"vector_linear_labels","description":"","fields":{"id":"Number","rclass":"Number","path_priority":"Number","name":"String"}},{"id":"vector_point_labels2","description":"","fields":{"placement_id":"Number","label_id":"Number","min_zoom":"Number","max_zoom":"Number","class":"Number","name":"String","name_len":"Number","display_class":"Number","feature_area":"Number"}},{"id":"vector_point_labels3","description":"","fields":{"placement_id":"Number","label_id":"Number","min_zoom":"Number","max_zoom":"Number","class":"Number","name":"String","name_len":"Number","display_class":"Number","feature_area":"Number"}}]}]]></Parameter>
  <Parameter name="maxzoom">16</Parameter>
  <Parameter name="minzoom">0</Parameter>
  <Parameter name="name"><![CDATA[MQ Carto Vector]]></Parameter>
</Parameters>


<Layer name="boundingbox"
  buffer-size="2"
  srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
    
    <Datasource>
       <Parameter name="file"><![CDATA[/home/pnorman/mq-carto-style-vector/10m-900913-bounding-box.shp]]></Parameter>
       <Parameter name="type"><![CDATA[shape]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="natearth_ocean_10m"
  buffer-size="2"
  srs="+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-180, -85.05112877980659, 180, 85.05112877980659]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT the_geom FROM natearth_ocean_10m) AS natearth_ocean_10m]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="natearth_lakes_10m"
  buffer-size="2"
  srs="+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-180, -85.05112877980659, 180, 85.05112877980659]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT the_geom FROM natearth_lakes_10m) AS natearth_lakes_10m]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="vector_polygonal_geometry"
  buffer-size="8"
  srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-20037508,-20037508,20037508,20037508]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT the_geom, id, rclass FROM
  (SELECT * FROM vector_polygonal_geometry_6 WHERE z(!scale_denominator!) >= 6 AND z(!scale_denominator!) < 8
  UNION ALL
  SELECT * FROM vector_polygonal_geometry_8 WHERE z(!scale_denominator!) >= 8 AND z(!scale_denominator!) < 10
  UNION ALL
  SELECT * FROM vector_polygonal_geometry_10 WHERE z(!scale_denominator!) >= 10 AND z(!scale_denominator!) < 12
  UNION ALL
  SELECT * FROM vector_polygonal_geometry_12 WHERE z(!scale_denominator!) >= 12 AND z(!scale_denominator!) < 16
  UNION ALL
  SELECT * FROM vector_polygonal_geometry_16 WHERE z(!scale_denominator!) >= 16) AS d
  ORDER BY area DESC
) AS vector_polygonal_geometry]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="vector_linear_county"
  buffer-size="8"
  srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-20037508,-20037508,20037508,20037508]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT * FROM vector_linear_geometry_8 WHERE rclass = 15 AND z(!scale_denominator!) >= 8 AND z(!scale_denominator!) < 10
UNION ALL
SELECT * FROM vector_linear_geometry_10 WHERE rclass = 15 AND z(!scale_denominator!) >= 10 AND z(!scale_denominator!) < 12
UNION ALL
SELECT * FROM vector_linear_geometry_12 WHERE rclass = 15 AND z(!scale_denominator!) >= 12 AND z(!scale_denominator!) < 16
UNION ALL
SELECT * FROM vector_linear_geometry_16 WHERE rclass = 15 AND z(!scale_denominator!) >= 16
) AS vector_linear_county]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="states"
  buffer-size="8"
  srs="+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-180, -85.05112877980659, 180, 85.05112877980659]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT the_geom, name, adm0_a3 FROM natearth_state_borders_10m) AS states]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="countries"
  buffer-size="8"
  srs="+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-180, -85.05112877980659, 180, 85.05112877980659]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT the_geom, name FROM natearth_country_borders_10m) AS countries]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="natearth_roads"
  buffer-size="8"
  srs="+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-180, -85.05112877980659, 180, 85.05112877980659]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT the_geom, type FROM natearth_roads_old WHERE type='Major Highway') AS natearth_roads]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="trans_linear"
  buffer-size="16"
  srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-20037508,-20037508,20037508,20037508]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT the_geom, rclass, ramp, toll, restriction, oneway, brunnel
  FROM (
    SELECT * FROM vector_linear_geometry_6 WHERE z(!scale_denominator!) >= 6 AND z(!scale_denominator!) < 8 -- rclass=15 does not appear here
    UNION ALL
    SELECT * FROM vector_linear_geometry_8 WHERE rclass IN (0, 1, 2) AND z(!scale_denominator!) >= 8 AND z(!scale_denominator!) < 10
    UNION ALL
    SELECT * FROM vector_linear_geometry_10 WHERE rclass IN (0, 1, 2, 3, 13) AND z(!scale_denominator!) >= 10 AND z(!scale_denominator!) < 12
    UNION ALL
    SELECT * FROM vector_linear_geometry_12 
      WHERE (z(!scale_denominator!) >= 12 AND z(!scale_denominator!) < 16) 
        AND (rclass IN (0, 1, 2, 3, 4, 13) 
          OR (rclass IN (6, 14) AND z(!scale_denominator!) >= 13)
          OR (rclass = 11 AND z(!scale_denominator!) >= 14))
    UNION ALL
    SELECT * FROM vector_linear_geometry_16 WHERE rclass != 15 AND z(!scale_denominator!) >= 16) AS r
  ORDER BY rclass DESC
) AS trans_linear]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="highway_labels"
  buffer-size="64"
  srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-20037508.34,-20037508.34,20037508.34,20037508.34]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT 
    the_geom, class, name, length(name) AS name_len, display_class
  FROM
  (SELECT
      placement_id, label_id, min_zoom, max_zoom, the_geom, class,
      unnest(text_elements) AS name, display_class, feature_area
    FROM
    (SELECT
        pl.*, (unnest(pr.labels)).* 
      FROM vector_point_label_placements pl
      INNER JOIN vector_point_label_properties pr ON pl.label_id = pr.label_id) x
    WHERE (class BETWEEN 1 AND 591 OR class IN (1040, 1041, 1042))
      AND z(!scale_denominator!) >= min_zoom
      AND (z(!scale_denominator!) < max_zoom+1 OR max_zoom IS NULL OR max_zoom = 18)
    ORDER BY display_class ASC, min_zoom DESC, class DESC) AS data0
) AS highway_labels]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="place_labels"
  buffer-size="64"
  srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-20037508,-20037508,20037508,20037508]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT 
    the_geom, class, name, length(name) AS name_len, display_class
  FROM
  (SELECT
      placement_id, label_id, min_zoom, max_zoom, the_geom, class,
      unnest(text_elements) AS name, display_class, feature_area
    FROM
    (SELECT
        pl.*, (unnest(pr.labels)).* 
      FROM vector_point_label_placements pl
      INNER JOIN vector_point_label_properties pr ON pl.label_id = pr.label_id) x
    WHERE class IN (1000, 1010, 1020, 1030, 1031, 1038) 
      AND z(!scale_denominator!) >= min_zoom
      AND (z(!scale_denominator!) < max_zoom+1 OR max_zoom IS NULL OR max_zoom = 18)
    ORDER BY display_class ASC, class DESC, min_zoom DESC, feature_area DESC) AS data0
) AS place_labels]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="highway_overlay"
  buffer-size="16"
  srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-20037508,-20037508,20037508,20037508]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT * FROM 
 (SELECT * FROM vector_linear_geometry_6 WHERE z(!scale_denominator!) >= 6 AND z(!scale_denominator!) < 8 -- rclass=15 does not appear here
  UNION ALL
  SELECT * FROM vector_linear_geometry_8 WHERE z(!scale_denominator!) >= 8 AND z(!scale_denominator!) < 10
  UNION ALL
  SELECT * FROM vector_linear_geometry_10 WHERE z(!scale_denominator!) >= 10 AND z(!scale_denominator!) < 12
  UNION ALL
  SELECT * FROM vector_linear_geometry_12 WHERE z(!scale_denominator!) >= 12 AND z(!scale_denominator!) < 16
  UNION ALL
  SELECT * FROM vector_linear_geometry_16 WHERE z(!scale_denominator!) >= 16) AS r
 WHERE rclass = 0
) AS highway_overlay]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="vector_linear_labels"
  buffer-size="64"
  srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-20037508,-20037508,20037508,20037508]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT * FROM vector_linear_labels 
  WHERE (rclass IN (1, 2, 3, 12, 16) AND z(!scale_denominator!) >= 10) -- major roads
    OR (rclass IN (4, 5, 6, 14, 11) AND z(!scale_denominator!) >= 14) -- minor roads, rivers, ferries, railways
  ORDER BY path_priority DESC, rclass DESC
) AS vector_linear_labels]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="vector_point_labels2"
  buffer-size="64"
  srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-20037508,-20037508,20037508,20037508]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT 
    placement_id, label_id, min_zoom, max_zoom, the_geom, class, name,
    length(name) AS name_len, display_class, feature_area 
  FROM 
  (SELECT
      placement_id, label_id, min_zoom, max_zoom, the_geom, class,
      unnest(text_elements) AS name, display_class, feature_area
    FROM 
    (SELECT 
        pl.*, (unnest(pr.labels)).* 
      FROM vector_point_label_placements pl 
      INNER JOIN vector_point_label_properties pr ON pl.label_id = pr.label_id) x
      WHERE class NOT IN (1000, 1010, 1020, 1030, 1031, 1038) 
        AND class NOT BETWEEN 1 AND 591
        AND class NOT IN (1040, 1041, 1042)
        AND z(!scale_denominator!) >= min_zoom 
        AND (z(!scale_denominator!) < max_zoom+1 OR max_zoom IS NULL OR max_zoom = 18)
    ORDER BY display_class ASC) 
  AS data0)
AS vector_point_labels2]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="vector_point_labels3"
  buffer-size="64"
  srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[]]></Parameter>
       <Parameter name="extent"><![CDATA[-20037508,-20037508,20037508,20037508]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[the_geom]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[(SELECT 
    placement_id, label_id, min_zoom, max_zoom, the_geom, class, name,
    length(name) AS name_len, display_class, feature_area 
  FROM 
  (SELECT
      placement_id, label_id, min_zoom, max_zoom, the_geom, class,
      unnest(text_elements) AS name, display_class, feature_area
    FROM 
    (SELECT 
        pl.*, (unnest(pr.labels)).* 
      FROM vector_point_label_placements pl 
      INNER JOIN vector_point_label_properties pr ON pl.label_id = pr.label_id) x
      WHERE class NOT IN (1000, 1010, 1020, 1030, 1031, 1038) 
        AND class NOT BETWEEN 1 AND 591
        AND class NOT IN (1040, 1041, 1042)
        AND z(!scale_denominator!) >= min_zoom 
        AND (z(!scale_denominator!) < max_zoom+1 OR max_zoom IS NULL OR max_zoom = 18)
    ORDER BY display_class ASC) 
  AS p)
AS vector_point_labels3]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

</Map>